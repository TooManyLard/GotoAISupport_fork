<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#00A599">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>GOTO AI Support</title>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- è¨€èªé¸æŠç”»é¢ -->
        <div class="language-select-screen" id="language-select-screen">
            <h1>GOTO AI Support</h1>
            <p>ãŠå¥½ã¿ã®è¨€èªã‚’é¸æŠã—ã¦ä¼šè©±ã‚’å§‹ã‚ã¾ã—ã‚‡ã†</p>
            
            <div class="language-grid">
                <div class="language-card" data-lang="en">
                    <div class="flag">ğŸ‡ºğŸ‡¸</div>
                    <div class="card-text">
                        <h3>English</h3>
                        <p>Start chatting in English</p>
                    </div>
                </div>
                
                <div class="language-card" data-lang="ja">
                    <div class="flag">ğŸ‡¯ğŸ‡µ</div>
                    <div class="card-text">
                        <h3>æ—¥æœ¬èª</h3>
                        <p>æ—¥æœ¬èªã§ãƒãƒ£ãƒƒãƒˆã‚’é–‹å§‹</p>
                    </div>
                </div>
                
                <div class="language-card" data-lang="ko">
                    <div class="flag">ğŸ‡°ğŸ‡·</div>
                    <div class="card-text">
                        <h3>í•œêµ­ì–´</h3>
                        <p>í•œêµ­ì–´ë¡œ ì±„íŒ… ì‹œì‘</p>
                    </div>
                </div>
                
                <div class="language-card" data-lang="zh">
                    <div class="flag">ğŸ‡¨ğŸ‡³</div>
                    <div class="card-text">
                        <h3>ä¸­æ–‡</h3>
                        <p>ç”¨ä¸­æ–‡å¼€å§‹èŠå¤©</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ç”»é¢ -->
        <div class="info-form-screen" id="info-form-screen">
            <h1 id="info-form-title">ç‰©ä»¶æƒ…å ±ã‚’å…¥åŠ›</h1>
            <p id="info-form-description">ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ãŸã‚ã«å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</p>
            
            <form class="info-form" id="property-form">
                <div class="form-group">
                    <label for="property-id" id="property-id-label">ç‰©ä»¶ID</label>
                    <input type="text" id="property-id" required autocomplete="off" inputmode="text">
                </div>
                
                <div class="form-group">
                    <label for="room-number" id="room-number-label">éƒ¨å±‹ç•ªå·</label>
                    <input type="text" id="room-number" required autocomplete="off" inputmode="text">
                </div>
                
                <div class="form-group">
                    <label for="issue-description" id="issue-label">ãŠå›°ã‚Šã®ã“ã¨</label>
                    <textarea id="issue-description" required></textarea>
                </div>
                
                <button type="submit" class="submit-btn" id="submit-info">é€ä¿¡</button>
            </form>
        </div>
        
        <!-- ãƒãƒ£ãƒƒãƒˆç”»é¢ -->
        <div class="chat-screen" id="chat-screen">
            <div class="chat-header">
                <h1>GOTO AI Support</h1>
                
                <div class="language-selector">
                    <button class="language-btn" data-lang="en">English</button>
                    <button class="language-btn" data-lang="ko">í•œêµ­ì–´</button>
                    <button class="language-btn" data-lang="ja">æ—¥æœ¬èª</button>
                    <button class="language-btn" data-lang="zh">ä¸­æ–‡</button>
                </div>
            </div>
            
            <div class="chat-container" id="chat-container">
                <div class="messages-container" id="messages-container">
                    <!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã“ã“ã«è¿½åŠ ã•ã‚Œã¾ã™ -->
                </div>
            </div>
            
            <div class="input-container">
                <input type="text" id="user-input" placeholder="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›..." aria-label="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å…¥åŠ›" autocomplete="off">
                <button class="send-btn" id="send-button" aria-label="ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã‚’ä¿å­˜
        let sessionId = null;
        // ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹è¨€èª
        let currentLanguage = 'ja'; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ï¼ˆåˆæœŸé¸æŠç”»é¢ã‹ã‚‰ã¯ä¸Šæ›¸ãã•ã‚Œã¾ã™ï¼‰
        // ç‰©ä»¶æƒ…å ±ã‚’ä¿å­˜
        let propertyInfo = {
            propertyId: '',
            roomNumber: '',
            issue: ''
        };

        // DOMè¦ç´ 
        const languageSelectScreen = document.getElementById('language-select-screen');
        const infoFormScreen = document.getElementById('info-form-screen');
        const chatScreen = document.getElementById('chat-screen');
        const chatContainer = document.getElementById('chat-container');
        const messagesContainer = document.getElementById('messages-container');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        const languageButtons = document.querySelectorAll('.language-btn');
        const languageCards = document.querySelectorAll('.language-card');
        const propertyForm = document.getElementById('property-form');

        // ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 
        const infoFormTitle = document.getElementById('info-form-title');
        const infoFormDescription = document.getElementById('info-form-description');
        const propertyIdLabel = document.getElementById('property-id-label');
        const roomNumberLabel = document.getElementById('room-number-label');
        const issueLabel = document.getElementById('issue-label');
        const submitInfoBtn = document.getElementById('submit-info');
        const propertyIdInput = document.getElementById('property-id');
        const roomNumberInput = document.getElementById('room-number');
        const issueInput = document.getElementById('issue-description');

        // è¨€èªé¸æŠã‚«ãƒ¼ãƒ‰åˆæœŸåŒ–
        languageCards.forEach(card => {
            card.addEventListener('click', () => {
                const selectedLang = card.dataset.lang;
                
                // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
                card.classList.add('active');
                setTimeout(() => {
                    // è¨€èªã‚’è¨­å®šã—ã¦æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã‚’è¡¨ç¤º
                    setupInfoForm(selectedLang);
                    card.classList.remove('active');
                }, 300);
            });
        });

        // æƒ…å ±å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
        function setupInfoForm(lang) {
            // è¨€èªã‚’è¨­å®š
            currentLanguage = lang;
            
            // è¨€èªãƒœã‚¿ãƒ³ã‚’æ›´æ–°
            updateLanguageButtons(lang);
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒ©ãƒ™ãƒ«ã¨ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨€èªã«åˆã‚ã›ã¦è¨­å®š
            const formTexts = {
                'en': {
                    title: 'Enter Property Information',
                    description: 'Please provide the necessary information to receive support',
                    propertyIdLabel: 'Property ID',
                    roomNumberLabel: 'Room Number',
                    issueLabel: 'Issue Description',
                    submitBtn: 'Submit'
                },
                'ja': {
                    title: 'ç‰©ä»¶æƒ…å ±ã‚’å…¥åŠ›',
                    description: 'ã‚µãƒãƒ¼ãƒˆã‚’å—ã‘ã‚‹ãŸã‚ã«å¿…è¦ãªæƒ…å ±ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„',
                    propertyIdLabel: 'ç‰©ä»¶ID',
                    roomNumberLabel: 'éƒ¨å±‹ç•ªå·',
                    issueLabel: 'ãŠå›°ã‚Šã®ã“ã¨',
                    submitBtn: 'é€ä¿¡'
                },
                'ko': {
                    title: 'ë¬¼ê±´ ì •ë³´ ì…ë ¥',
                    description: 'ì§€ì›ì„ ë°›ê¸° ìœ„í•´ í•„ìš”í•œ ì •ë³´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”',
                    propertyIdLabel: 'ë¬¼ê±´ ID',
                    roomNumberLabel: 'ë°© ë²ˆí˜¸',
                    issueLabel: 'ë¬¸ì œ ì„¤ëª…',
                    submitBtn: 'ì œì¶œ'
                },
                'zh': {
                    title: 'è¾“å…¥ç‰©ä¸šä¿¡æ¯',
                    description: 'è¯·æä¾›å¿…è¦ä¿¡æ¯ä»¥è·å–æ”¯æŒ',
                    propertyIdLabel: 'ç‰©ä¸šID',
                    roomNumberLabel: 'æˆ¿é—´å·',
                    issueLabel: 'é—®é¢˜æè¿°',
                    submitBtn: 'æäº¤'
                }
            };
            
            const texts = formTexts[lang] || formTexts['en'];
            
            infoFormTitle.textContent = texts.title;
            infoFormDescription.textContent = texts.description;
            propertyIdLabel.textContent = texts.propertyIdLabel;
            roomNumberLabel.textContent = texts.roomNumberLabel;
            issueLabel.textContent = texts.issueLabel;
            submitInfoBtn.textContent = texts.submitBtn;
            
            // è¡¨ç¤ºåˆ‡æ›¿ï¼ˆãƒˆãƒ©ãƒ³ã‚¸ã‚·ãƒ§ãƒ³åŠ¹æœä»˜ãï¼‰
            languageSelectScreen.style.opacity = '0';
            setTimeout(() => {
                languageSelectScreen.style.display = 'none';
                infoFormScreen.style.display = 'flex';
                infoFormScreen.style.opacity = '0';
                
                setTimeout(() => {
                    infoFormScreen.style.opacity = '1';
                    // ãƒ•ã‚©ãƒ¼ãƒ ã®æœ€åˆã®å…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
                    propertyIdInput.focus();
                }, 50);
            }, 300);
        }

        // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡å‡¦ç†
        propertyForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // ãƒ•ã‚©ãƒ¼ãƒ ã®å€¤ã‚’å–å¾—ã—ã¦ä¿å­˜
            propertyInfo = {
                propertyId: propertyIdInput.value.trim(),
                roomNumber: roomNumberInput.value.trim(),
                issue: issueInput.value.trim()
